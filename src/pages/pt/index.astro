---
import Layout from "../../layouts/Layout.astro";
import Navigation from "../../components/Navigation.astro";
import Hero from "../../components/Hero.astro";
import About from "../../components/About.astro";
import Experience from "../../components/Experience.astro";
// import Projects from '../../components/Projects.astro';
import Contact from "../../components/Contact.astro";
import Footer from "../../components/Footer.astro";
import { getLangFromUrl } from "../../i18n/utils";
import { supabase } from "../../lib/supabase";

const lang = getLangFromUrl(Astro.url);

// Fetch personal info for title/SEO
const { data: personalInfo } = await supabase
    .from("personal_info")
    .select("full_name, seo_description, seo_keywords")
    .single();

const { data: titleTranslation } = await supabase
    .from("personal_info_translations")
    .select("title")
    .eq("language_code", lang)
    .single();

const siteAuthor = personalInfo?.full_name || "Developer";
const siteTitle = titleTranslation?.title || "";
const siteDescription = personalInfo?.seo_description || "";
const siteKeywords = personalInfo?.seo_keywords || "";

const pageTitle = siteTitle ? `${siteAuthor} - ${siteTitle}` : siteAuthor;
---

<Layout
    title={pageTitle}
    description={siteDescription}
    keywords={siteKeywords}
    author={siteAuthor}
    canonical="/pt/"
>
    <Navigation />
    <main>
        <Hero />
        <About />
        <Experience />
        <!-- <Projects /> -->
        <Contact />
    </main>
    <Footer />
</Layout>

<style>
    html {
        scroll-behavior: smooth;
    }

    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
</style>
